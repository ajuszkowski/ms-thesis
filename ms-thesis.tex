% Aalto Master's Thesis template
% Compatible with: UTF-8, pdflatex, biblatex, biber
%
% Compile using the following commands:
% $ pdflatex thesis.tex
% $ biber thesis
% $ pdflatex thesis.tex
% $ pdflatex thesis.tex
% $ pdflatex thesis.tex
%

\documentclass[12pt,a4paper,oneside,pdftex]{report}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[finnish,swedish,english]{babel}
%\usepackage[english]{babel}


\usepackage{fancyvrb}%fancy verbatim
%\makeatletter
%\newcommand{\verbatimfont}[1]{\renewcommand{\verbatim@font}{\ttfamily\scriptsize#1}}
%\makeatother
% redefine \VerbatimInput
\RecustomVerbatimCommand{\VerbatimInput}{VerbatimInput}{fontsize=\scriptsize}

\usepackage{pmboxdraw}
\usepackage{newunicodechar}
\newunicodechar{└}{\textSFii}
\newunicodechar{├}{\textSFviii}
\newunicodechar{─}{\textSFx}


\usepackage{wrapfig} %for text wrap around figures
\usepackage{paracol}%2 columns

\usepackage[section]{placeins}

\usepackage{mathtools}
\usepackage{appendix}

\usepackage{fancyhdr}

\usepackage{mfirstuc}%title case

%\usepackage[final]{pdfpages}
\usepackage[export]{adjustbox} % loads also graphicx

%\newcommand{\pvec}[1]{\vec{#1}\mkern2mu\vphantom{#1}} %for primed vectors, see https://tex.stackexchange.com/a/120034
\newcommand{\pvec}[1]{\vec{#1}\,}

% Font selection
%\usepackage{palatino}
%\usepackage[sc]{mathpazo}
\usepackage{kpfonts}
%\usepackage{tgpagella}
%\usepackage{garamond}
%\usepackage{lmodern}

% Verbatim provides a standard teletype environment that renderes
% the text exactly as written in the tex file. Useful for code
% snippets (although you can also use the listings package to get
% automatic code formatting).
\usepackage{verbatim}
\usepackage{enumitem} % for nolistsep in enumeration
\usepackage{multicol} % for using multiple columns in listings

\usepackage{listings}
\usepackage{inc/listingset}


\renewcommand{\labelitemii}{$\circ$}

\lstset{ 
    columns=[l]fullflexible,
    keepspaces=true,
    basicstyle=\ttfamily\small,
    %numbers=left,
    tabsize=2,
    captionpos=b,
    escapeinside={[*}{*]},
    %keywordstyle={\ttfamily\color{red}},
}
\newcommand{\tool}[1]{\texttt{#1}}

\newcommand*{\fx}{\ensuremath{\mathbf{x}}}%x}}}
\newcommand*{\fv}{\ensuremath{\mathbf{v}}} %v}}}

\newcommand{\porthos}[1][]{%
\texttt{porthos\ifthenelse%
{\equal{#1}{}}%if
{}%then
{\ifthenelse{\equal{#1}{1}}%else-if
{}%then%{\,v1}%then
{#1}%else
}}}
\newcommand{\oldporthos}{\porthos[1]}
\newcommand{\rf}{\ensuremath{\,\mathtt{rf}\,}}
\newcommand{\fr}{\ensuremath{\,\mathtt{fr}\,}}
\newcommand{\po}{\ensuremath{\,\mathtt{po}\,}}
\newcommand{\co}{\ensuremath{\,\mathtt{co}\,}}
\newcommand{\com}{\ensuremath{\,\mathtt{po}\,}}
\newcommand{\sr}{\ensuremath{\,\mathtt{sr}\,}}
\newcommand{\cat}{\texttt{cat}\;}
\newcommand{\relation}[1]{\ensuremath{\overset{\mathtt{#1}}{\rightarrow}}}
\newcommand{\rel}[1]{\texttt{#1}}
\newcommand{\mathr}[1]{\ensuremath{\mathtt{#1}}}
\newcommand{\invrel}[1]{\ensuremath{\mathr{#1}\!\!\mathbin{\char`\^}\!\!\text{-1}}} %inversion or a relation in math mode: r^-1

\newcommand{\ytree}{\ensuremath{\text{Y-tree}}}
\newcommand{\wmodel}{\ensuremath{\text{W-model}}}%\mathtt{W\text{-}model}}}
\newcommand{\zformula}{\ensuremath{\text{Z-formula}}}
\newcommand{\xgraph}[1][]{\ensuremath{\text{X-graph}
\ifthenelse%
{\equal{#1}{}}%if
{}%then
{_{\text{\tiny{#1}}}}%else
}}
\newcommand{\xgraphU}[1][]{\ensuremath{\text{X-graph}%\mathtt{X\text{-}graph%unrolled x-graph
\ifthenelse%
{\equal{#1}{}}%if
{}%then
{_{\text{\tiny{#1}}}^{\text{\tiny{U}}}}%else
}}

\sloppy %forbid page overfull with texttt words

\usepackage{outlines} %for nested itemize lists

% Longtable provides a tabular environment that can span multiple
% pages. This is used in the example abbreviations file.
\usepackage{longtable}

% The titlesec package can be used to alter the look of the titles
% of sections, chapters, and so on. This example uses the ``medium''
% package option which sets the titles to a medium size, making them
% a bit smaller than what is the default. You can fine-tune the
% title fonts and sizes by using the package options. See the package
% documentation.
%\usepackage[medium]{titlesec}
\usepackage[medium,raggedright]{titlesec}
%\usepackage{pxfonts} %for listings

\usepackage[position=b]{subcaption}
\captionsetup[subfigure]{font=scriptsize,justification=centering}
\usepackage{graphicx}

\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{calc}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations.pathmorphing,decorations.markings}
\usetikzlibrary{shapes}
\usetikzlibrary{patterns}
\usetikzlibrary{automata}

\tikzset{initial text={}}
%\tikzset{%
%  zeroarrow/.style = {-stealth,dashed},
%  onearrow/.style = {-stealth,solid},
%  c/.style = {circle,draw,solid,
%    minimum width=3cm,
%    minimum height=3cm,
%    },
%  r/.style = {rectangle,draw,solid,minimum width=2em,
%    minimum height=2em}
%}
\tikzset{
c/.style={
  circle,solid,
  inner sep=0pt,
  %text width=1mm,
  minimum width=7mm,
  align=center,
  draw=black,
  fill=white
  }
}

\usepackage{amsthm}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\renewcommand{\algorithmicrequire}[1]{\textbf{Input:} {#1}\\}
\renewcommand{\algorithmicensure}[1]{\textbf{Output:} {#1}}
\renewcommand{\algorithmicforall}{\textbf{for each}}
\newcommand{\Break}{\State\algorithmicbreak}

% Microtype for better typography
\usepackage[stretch=30,protrusion=true,final,expansion,tracking=true,kerning,spacing]{microtype}

% SI units. See table in 2lorem.tex for example
\usepackage{siunitx}
\sisetup{
    alsoload=binary
}

% Publication quality tables. See table in 2lorem.tex for example
\usepackage{booktabs}
% Use biber instead of bibtex as it supports UTF-8 among other things
\usepackage[backend=biber,
%maxnames=5,
%style=numeric-verb,
style=alphabetic,%-verb,%style=alphabetic
minalphanames=3,
maxalphanames=3,
%sortcites=true,
%sorting=none
%see options: http://texdoc.net/texmf-dist/doc/latex/biblatex/biblatex.pdf
%sorting=anyvt,%Sort by alphabetic label, name, year, volume, title,
sorting=anyt,%Sort by alphabetic label, name, year, title,
%sorting=ydnt,%Sort by year (descending), name, title 
%sorting=ynt, %Sort by year, name, title. 
%sorting=nyt, %Sort by name, year, title. %see https://tex.stackexchange.com/a/51439
]{biblatex}
% A catch-all filter for all items which are not assigned to a dedicated sub-bibliography:
%\defbibfilter{other}{
%  not type=article
%  and
%  not type=book
%  and
%  not type=collection
%}
%make the plus sign in bibliography references as superscript:
\renewcommand*{\labelalphaothers}{\textsuperscript{+}}


% Separate multiple citations with space instead of comma
% E.g. "[1] [2] [3]" instead of "[1], [2], [3]"
%\renewcommand\multicitedelim{\space}
%separate them by semicolon
\renewcommand*{\multicitedelim}{\setunit{; }}


% Nicer looking caption for figures, tables, etc.
\usepackage[labelfont={bf},textfont={it},justification={raggedright},singlelinecheck={false}]{caption}

% Multiple figures inside one figure. See figure in 1lipsum.tex for example
%\usepackage{subfig}

% Inconsolata monospace font for verbatim environment
\usepackage{inconsolata}

% For rotating figures
\usepackage{rotating}

\usepackage{hyphenat} % for using \nohyphens

% Prevent orphan and widow rows
\widowpenalty=10000
\clubpenalty=10000

% Bibliography
\addbibresource{bib/ms-thesis.bib}

% The aalto-thesis package provides typesetting instructions for the
% standard -thesis parts (abstracts, front page, and so on)
% Load this package second-to-last, just before the hyperref package.
% Options that you can use:
%   mydraft - renders the thesis in draft mode.
%             Do not use for the final version.
%   doublenumbering - [optional] number the first pages of the thesis
%                     with roman numerals (i, ii, iii, ...); and start
%                     arabic numbering (1, 2, 3, ...) only on the
%                     first page of the first chapter
%   twoinstructors  - changes the title of instructors to plural form
%   twosupervisors  - changes the title of supervisors to plural form
%\usepackage[mydraft,doublenumbering]{aalto-thesis}
\usepackage[doublenumbering,twosupervisors]{lib/aalto-thesis}


% Hyperref
% ------------------------------------------------------------------
% Hyperref creates links from URLs, for references, and creates a
% TOC in the PDF file.
% This package must be the last one you include, because it has
% compatibility issues with many other packages and it fixes
% those issues when it is loaded.
\RequirePackage[pdftex]{hyperref}
% Setup hyperref so that links are clickable but do not look
% different
\hypersetup{colorlinks=false,raiselinks=false,breaklinks=true}
\hypersetup{pdfborder={0 0 0}}
\hypersetup{bookmarksnumbered=true}
% The following line suggests the PDF reader that it should show the
% first level of bookmarks opened in the hierarchical bookmark view.
\hypersetup{bookmarksopen=true,bookmarksopenlevel=1}
% Hyperref can also set up the PDF metadata fields. These are
% set a bit later on, after the thesis setup.


% Thesis setup
% ==================================================================
% Change these to fit your own thesis.
% \COMMAND always refers to the English version;
% \FCOMMAND refers to the Finnish version; and
% \SCOMMAND refers to the Swedish version.
% You may comment/remove those language variants that you do not use
% (but then you must not include the abstracts for that language)
% ------------------------------------------------------------------
% If you do not find the command for a text that is shown in the cover page or
% in the abstract texts, check the aalto-thesis.sty file and locate the text
% from there.
% All the texts are configured in language-specific blocks (lots of commands
% that look like this: \renewcommand{\ATCITY}{Espoo}.
% You can just fix the texts there. Just remember to check all the language
% variants you use (they are all there in the same place).
% ------------------------------------------------------------------
\newcommand{\TITLE}{\nohyphens{Automated Analysis of Weak Memory Models}}
%\newcommand{\FTITLE}{?}
%\newcommand{\FSUBTITLE}{}
%\newcommand{\FDATE}{?.?.2018} % TODO
\newcommand{\SUBTITLE}{}
\newcommand{\DATE}{?.?.2018 \textbf{TODO}} % TODO

% Supervisors and instructors
% ------------------------------------------------------------------
% If you have two supervisors, write both names here, separate them with a
% double-backslash (see below for an example)
% Also remember to add the package option ``twosupervisors'' or
% ``twoinstructors'' to the aalto-thesis package so that the titles are in
% plural.
% Example of one supervisor:
\newcommand{\SUPERVISOR}{Assoc. Prof. Keijo Heljanko\\Docent Igor I. Komarov} % TODO
%\newcommand{\FSUPERVISOR}{} % TODO
%\newcommand{\SSUPERVISOR}{} % TODO

% If you have only one instructor, just write one name here
%\newcommand{\INSTRUCTOR}{} % TODO
%\newcommand{\FINSTRUCTOR}{} % TODO
%\newcommand{\SINSTRUCTOR}{} % TODO
% If you have two instructors, separate them with \\ to create linefeeds
% \newcommand{\INSTRUCTOR}{Olli Ohjaaja M.Sc. (Tech.)\\
%  Elli Opas M.Sc. (Tech)}
%\newcommand{\FINSTRUCTOR}{Diplomi-insinööri Olli Ohjaaja\\
%  Diplomi-insinööri Elli Opas}
%\newcommand{\SINSTRUCTOR}{Diplomingenjör Olli Ohjaaja\\
%  Diplomingenjör Elli Opas}

% If you have two supervisors, it is common to write the schools
% of the supervisors in the cover page. If the following command is defined,
% then the supervisor names shown here are printed in the cover page. Otherwise,
% the supervisor names defined above are used.
%\newcommand{\COVERSUPERVISOR}{Professor Antti Ylä-Jääski, Aalto University\\
%  Professor Pekka Perustieteilijä, University of Helsinki}

% The same option is for the instructors, if you have multiple instructors.
% \newcommand{\COVERINSTRUCTOR}{Olli Ohjaaja M.Sc. (Tech.), Aalto University\\
%  Elli Opas M.Sc. (Tech), Aalto SCI}


% Other stuff
% ------------------------------------------------------------------
%\newcommand{\PROFESSORSHIP}{} % TODO
%\newcommand{\FPROFESSORSHIP}{?} % TODO check
% Professorship code is the same in all languages
%\newcommand{\PROFCODE}{AS-116} % TODO check
\newcommand{\KEYWORDS}{\textbf{TODO: }Thesis template, master's thesis} % TODO
%\newcommand{\FKEYWORDS}{Diplomityöpohja} % TODO
\newcommand{\LANGUAGE}{English}
%\newcommand{\FLANGUAGE}{Englanti} % TODO

% Author is the same for all languages
\newcommand{\AUTHOR}{Artem YUSHKOVSKIY}

% Currently the English versions are used for the PDF file metadata
% Set the PDF title
\hypersetup{pdftitle={\TITLE\ \SUBTITLE}}
% Set the PDF author
\hypersetup{pdfauthor={\AUTHOR}}
% Set the PDF keywords
\hypersetup{pdfkeywords={\KEYWORDS}}
% Set the PDF subject
\hypersetup{pdfsubject={Master's Thesis}}


% Layout settings
% ------------------------------------------------------------------

% When you write in English, you should use the standard LaTeX
% paragraph formatting: paragraphs are indented, and there is no
% space between paragraphs.
% When writing in Finnish, we often use no indentation in the
% beginning of the paragraph, and there is some space between the
% paragraphs.

% If you write your thesis Finnish, uncomment these lines; if
% you write in English, leave these lines commented!
%\setlength{\parindent}{0pt}
%\setlength{\parskip}{1ex}

% Use this to control how much space there is between each line of text.
% 1 is normal (no extra space), 1.3 is about one-half more space, and
% 1.6 is about double line spacing.
\linespread{1.05}
% \linespread{1.3}

% Extra hyphenation settings
% ------------------------------------------------------------------
% You can list here all the files that are not hyphenated correctly.
% You can provide many \hyphenation commands and/or separate each word
% with a space inside a single command. Put hyphens in the places where
% a word can be hyphenated.
% Note that (by default) LaTeX will not hyphenate words that already
% have a hyphen in them (for example, if you write ``structure-modification
% operation'', the word structure-modification will never be hyphenated).
% You need a special package to hyphenate those words.
%\hyphenation{di-gi-taa-li-sta}


% Proper style for book binding, left margin bigger than right margin
% Uncomment to take into use
%\setlength{\parindent}{0pt}
%\setlength{\parskip}{2ex}
%\setlength{\textwidth}{140mm}
%\setlength{\oddsidemargin}{20mm}
%\setlength{\evensidemargin}{20mm}
%\setlength{\textheight}{240mm}
%\setlength{\voffset}{3mm}
%\setlength{\topmargin}{-11mm}


%\definecolor{pblue}{rgb}{0.13,0.13,1}
%\definecolor{pgreen}{rgb}{0,0.5,0}
%\definecolor{pred}{rgb}{0.9,0,0}
%\definecolor{pgrey}{rgb}{0.46,0.45,0.48}
%\lstset{
%  showspaces=false,
%  showtabs=false,
%  breaklines=true,
%  showstringspaces=false,
%  breakatwhitespace=true,
%  commentstyle=\color{pgreen},
%  keywordstyle=\color{pblue},
%  stringstyle=\color{pred},
%  basicstyle=\ttfamily\scriptsize,
%  moredelim=[il][\textcolor{pgrey}]{$$},
%  moredelim=[is][\textcolor{pgrey}]{\%\%}{\%\%}
%}

% The preamble ends here, and the document begins.
% Place all formatting commands and such before this line.
% ------------------------------------------------------------------
\begin{document}
% This command adds a PDF bookmark to the cover page. You may leave
% it out if you don't like it...
\pdfbookmark[0]{Cover}{bookmark.0.cover}
% This command is defined in aalto-thesis.sty. It controls the page
% numbering based on whether the doublenumbering option is specified
\startcoverpage

% Cover page
% ------------------------------------------------------------------
% Options: finnish, english, and swedish
% These control in which language the cover-page information is shown
  \coverpage{english}


% Abstracts
% ------------------------------------------------------------------
% Include an abstract in the language that the thesis is written in,
% and if your native language is Finnish or Swedish, one in that language.

% Abstract in English
% ------------------------------------------------------------------
\thesisabstract{english}{
In id fringilla velit. Maecenas sed ante sit amet nisi iaculis bibendum sed vel
elit. Quisque eleifend lacus nec ipsum lobortis ornare. Nam lectus diam,
facilisis eget porttitor ac, fringilla quis massa. Phasellus ac dolor sem, eget
varius lacus. Sed sit amet ipsum eget arcu tristique aliquam. Integer aliquam
velit sit amet odio tempus commodo. Quisque commodo lacus in leo sagittis vel
dignissim quam vestibulum. Cras fringilla velit et diam dictum faucibus.
Pellentesque at eros non mauris auctor euismod. Nullam convallis arcu vel lectus
sollicitudin rutrum. Praesent consequat, nisl at pretium posuere, neque arcu
dapibus lacus, ut sollicitudin elit velit ultricies libero. Vestibulum ante
ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae;

Nulla semper hendrerit molestie. Pellentesque blandit velit sit amet est
vestibulum faucibus. Nullam massa turpis, venenatis non mollis fringilla, mattis
et diam. Fusce molestie convallis elementum. Morbi nec lacus dapibus arcu mollis
gravida. Aliquam erat volutpat. Nam vitae magna nunc. Nunc ut ipsum at massa
porttitor vestibulum. Praesent diam lorem, ultrices nec vestibulum id, volutpat
nec lacus.
}

% Acknowledgements
% ------------------------------------------------------------------
% Select the language you use in your acknowledgements
\selectlanguage{english}

% Uncomment this line if you wish acknoledgements to appear in the
% table of contents
%\addcontentsline{toc}{chapter}{Acknowledgements}

% The star means that the chapter isn't numbered and does not
% show up in the TOC
\chapter*{Acknowledgements} % TODO
%Prof. Keijo Heljanko
%Prof. Stavros Tripakis
%Vladimir Kochetkov and Stanislav Matveyev
In id fringilla velit. Maecenas sed ante sit amet nisi iaculis bibendum sed vel
elit. Quisque eleifend lacus nec ipsum lobortis ornare. Nam lectus diam,
facilisis eget porttitor ac, fringilla quis massa. Phasellus ac dolor sem, eget
varius lacus. Sed sit amet ipsum eget arcu tristique aliquam. Integer aliquam
velit sit amet odio tempus commodo. Quisque commodo lacus in leo sagittis vel
dignissim quam vestibulum. Cras fringilla velit et diam dictum faucibus.
Pellentesque at eros non mauris auctor euismod. Nullam convallis arcu vel lectus
sollicitudin rutrum. Praesent consequat, nisl at pretium posuere, neque arcu
dapibus lacus, ut sollicitudin elit velit ultricies libero. Vestibulum ante
ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae;

\vskip 10mm

\noindent Saint Petersburg \& Espoo 
\newline
\DATE
\vskip 5mm
\noindent Artem Yushkovskiy

% Acronyms
% ------------------------------------------------------------------
% Use \cleardoublepage so that IF two-sided printing is used
% (which is not often for masters theses), then the pages will still
% start correctly on the right-hand side.
\cleardoublepage
% Example acronyms are placed in a separate file, abbreviations.tex
\input{abbreviations}

% Table of contents
% ------------------------------------------------------------------
\cleardoublepage
% This command adds a PDF bookmark that links to the contents.
% You can use \addcontentsline{} as well, but that also adds contents
% entry to the table of contents, which is kind of redundant.
% The text ``Contents'' is shown in the PDF bookmark.
\pdfbookmark[0]{Table of contents}{bookmark.0.contents}
\tableofcontents

% List of tables
% ------------------------------------------------------------------
% You only need a list of tables for your thesis if you have very
% many tables. If you do, uncomment the following two lines.
% \cleardoublepage
% \listoftables

% Table of figures
% ------------------------------------------------------------------
% You only need a list of figures for your thesis if you have very
% many figures. If you do, uncomment the following two lines.
% \cleardoublepage
% \listoffigures

% The following label is used for counting the prelude pages
\label{pages-prelude}
\cleardoublepage

%%%%%%%%%%%%%%%%% The main content starts here %%%%%%%%%%%%%%%%%%%%%
% ------------------------------------------------------------------
% This command is defined in aalto-thesis.sty. It controls the page
% numbering based on whether the doublenumbering option is specified
\startfirstchapter

% Add headings to pages (the chapter title is shown)
%\pagestyle{headings}
\pagestyle{fancy}
\renewcommand{\headrulewidth}{0.5pt}
\fancyhf{}
\rhead{\footnotesize\itshape{\leftmark}}
\cfoot{\thepage}

\interfootnotelinepenalty=10000


\definecolor{dkblue}{rgb}{0,0.1,0.4}

%\titleformat{\paragraph}[display]{\normalsize\bfseries}{}{0pt}{}
\titleformat{\paragraph}[hang]{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}{0pt}{1em}{0pt}

% The contents of the thesis are separated to their own files.
% Edit the content in these files, rename them as necessary.
% ------------------------------------------------------------------
\input{1_intro.tex}
\input{2_wmm.tex}
\input{3_encod.tex}
\input{4_impl.tex}
\input{5_eval.tex}
\input{99_summary.tex}

% Fix numbering of bibliography section
\cleardoublepage
\phantomsection

\addcontentsline{toc}{chapter}{\bibname}

\printbibliography
%% And now the sub-bibliographies: we use three of them (based on the entry type). Each sub-bibliography assigns a different prefix. The option is called 'prefixnumbers' because it was originally intended for numeric citations only. It also works with alphabetic labels:
%\printbibliography[heading=subbibliography,title={Articles},type=article]%,prefixnumbers={A-}]
%\printbibliography[heading=subbibliography,title={Books},type=book]%,prefixnumbers={B-}]
%\printbibliography[heading=subbibliography,title={Collections},type=collection]%,prefixnumbers={C-}]

% Appendices go here
% ------------------------------------------------------------------
% Fix numbering of bibliography section
%\cleardoublepage

\renewcommand{\thesection}{A.\arabic{section}}
\titlespacing*{\section}{0pt}{-40pt}{20pt}
\titleformat{\section}[display]
  {\normalfont\large\bfseries}% <- font for label "A.1", default \huge
  {}
  {0ex}
  {\thesection\quad\large}% <- font for title, default \Huge

\cleardoublepage\makeatletter\@openrightfalse\makeatother
\phantomsection
\appendix
\addcontentsline{toc}{chapter}{Appendices}
\fancyhead[R]{\footnotesize\itshape{APPENDICES}}
%\chapter*{Appendices}
\appendixpage

\input{98_apx_grammar.tex}
\input{97_apx_trees.tex}

% End of document!
% ------------------------------------------------------------------
% The LastPage package automatically places a label on the last page.
% That works better than placing a label here manually, because the
% label might not go to the actual last page, if LaTeX needs to place
% floats (that is, figures, tables, and such) to the end of the
% document.
\end{document}

